(()=>{"use strict";({136:function(){var e=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{d(o.next(e))}catch(e){s(e)}}function u(e){try{d(o.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,u)}d((o=o.apply(e,t||[])).next())}))};let t={};const n="https://gluon.proton.ai";function o({tabId:e}){t=Object.assign(Object.assign({},t),{[e]:{}})}chrome.runtime.onMessage.addListener(((e,n,r)=>{"popup-opened"===e.event&&r(t),"clear-history"===e.event&&(o({tabId:e.tabId}),r(t))})),chrome.tabs.onUpdated.addListener((function(n,r){return e(this,void 0,void 0,(function*(){"loading"===(null==r?void 0:r.status)&&(t[n]||o({tabId:n}))}))})),chrome.tabs.onCreated.addListener((function(e){o({tabId:e})})),chrome.webRequest.onBeforeRequest.addListener((function(o){(()=>{e(this,void 0,void 0,(function*(){const{origin:r,pathname:s,searchParams:i}=new URL(o.url.toString());if(r!==n)return;const u=(yield function(){return e(this,void 0,void 0,(function*(){let[e]=yield chrome.tabs.query({active:!0,lastFocusedWindow:!0});return e}))}()).url,d=s.split("/").reverse()[0],{url:a,requestId:c,method:l,timeStamp:m,tabId:h}=o,f="login"===d,p="track"===d||f;let v;if(o.requestBody){const e=o.requestBody.raw[0].bytes,t=new TextDecoder("utf-8"),n=e&&new Uint8Array(e);v=JSON.parse(t.decode(n))}t[h][c]={requestId:c,status:"pending",statusCode:void 0,statusLine:void 0,method:l,timeStamp:m,url:a,referer:u,type:p?"track":"recommendation",model:f?"login":p?v.event:"recommendations"===d?"general":d,payload:p?v:{customer_id:i.get("customer_id"),product_id:i.get("product_id"),user_id:i.get("user_id"),count:i.get("count")}},chrome.runtime.sendMessage({event:"history-updated",history:t})}))})()}),{urls:["<all_urls>"]},["requestBody"]),chrome.webRequest.onCompleted.addListener((function(e){const{origin:o}=new URL(e.url.toString());if(o!==n)return;const{requestId:r,statusCode:s,tabId:i,statusLine:u}=e,d=s<300?"success":"fail";t[i][r].status=d,t[i][r].statusCode=s,t[i][r].statusLine=u,chrome.runtime.sendMessage({event:"history-updated",history:t})}),{urls:["<all_urls>"]})}})[136]()})();